<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.75.1"><meta charset=utf-8><title>scikit-learn in 2020</title><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black-translucent"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><link rel=stylesheet href=/2020-czi-scikit-learn/reveal-js/css/reset.css><link rel=stylesheet href=/2020-czi-scikit-learn/reveal-js/css/reveal.css><link rel=stylesheet href=/2020-czi-scikit-learn/_.min.ce5a976f843d2e456dcea8b382e8869c951bf763e49ae1d5bb8743da50934b91.css id=theme><link rel=stylesheet href=/2020-czi-scikit-learn/highlight-js/monokai.min.css></head><body><div class=reveal><div class=slides><section><h1 id=scikit-learn-in-2020>scikit-learn in 2020</h1><div class="g g-middle"><div class=g-1><figure><img src=images/czi_logo.png width=300px></figure></div><div class=g-1><figure><img src=images/columbia.png width=300px></figure></div><div class=g-1><figure><img src=images/scikit-learn-logo.png width=300px></figure></div></div><p>Thomas J. Fan</p><p><strong>Data Science Institute @ Columbia University</strong></p><div></div><a class=this-talk-link , href=https://github.com/thomasjpfan/2020-czi-scikit-learn target=_blank>This talk on Github: thomasjpfan/2020-czi-scikit-learn</a></section><section><h1 id=contents->Contents ðŸ“–</h1><ol><li>Organizational Updates @ scikit-learn</li><li>Advances in scikit-learn</li><li>Improvements of the new fast gradient boosting models</li></ol></section><section><section data-shortcode-section><h1 id=organizational-updates--scikit-learn>Organizational Updates @ scikit-learn</h1><figure><img src=images/scikit-learn-logo.png width=300px></figure></section><section><figure><img src=images/issues-and-prs.png></figure></section><section><h1 id=triage-team>Triage Team!</h1><figure><img src=images/triage-team.png height=500px></figure></section><section><h1 id=triage-team-responsibilities>Triage Team Responsibilities</h1><figure><img src=images/labels.png height=500px></figure><ul><li>Labels for issues and PRs</li><li>Determine if a PR must be relabeled as stalled</li><li>Close duplicate issues and issues that cannot be replicated</li></ul></section><section><h1 id=new-core-developer-lorentzenchr>New core developer: @lorentzenchr</h1><ul><li>Lead Generalized Linear Models development:<ul><li><strong>Tweedie distributions</strong></li><li><strong>Poisson</strong>: Tweedie with <code>power=1, link='log'</code></li><li><strong>Gamma</strong>: Tweedie with <code>power=2, link='log'</code></li></ul></li></ul><pre><code class=language-python>from sklearn.linear_model import TweedieRegressor
from sklearn.linear_model import PoissonRegressor
from sklearn.linear_model import GammaRegressor
</code></pre><figure><img src=images/poisson_gamma_tweedie_distributions.png width=1000px></figure></section><section><h1 id=examples-of-distributions>Examples of distributions</h1><ul><li><p>Risk modeling / insurance policy pricing:</p><ul><li>number of claim events / policyholder per year (Poisson)</li><li>cost per event (Gamma)</li></ul></li><li><p>Agriculture / weather modeling:</p><ul><li>number of rain events per year (Poisson)</li><li>amount of rainfall per event (Gamma)</li></ul></li></ul></section><section><h3 id=usage-examples>Usage Examples</h3><ul><li><a href=https://scikit-learn.org/stable/modules/linear_model.html#generalized-linear-regression>User Guide</a></li><li><a href=https://scikit-learn.org/stable/auto_examples/linear_model/plot_poisson_regression_non_normal_loss.html#sphx-glr-auto-examples-linear-model-plot-poisson-regression-non-normal-loss-py>Poisson regression and non-normal loss</a></li><li><a href=https://scikit-learn.org/stable/auto_examples/linear_model/plot_tweedie_regression_insurance_claims.html#sphx-glr-auto-examples-linear-model-plot-tweedie-regression-insurance-claims-py>Tweedie regression on insurance claims</a></li></ul><figure><img src=images/glm-dist.png></figure></section></section><section><section data-shortcode-section><h1 id=advances-in-scikit-learn->Advances in scikit-learn ðŸ› </h1></section><section><h1 id=showcasing-work-by-nicolas-hug>Showcasing Work by Nicolas Hug</h1><h2 id=nicolashughttpsgithubcomnicolashug><a href=https://github.com/nicolashug>@nicolashug</a></h2></section><section><h1 id=sequential-feature-selection>Sequential Feature Selection</h1><p>Greedy procedure that iteratively finds the best new feature to add to the set of selected features.</p><pre><code class=language-python>from sklearn.feature_selection import SequentialFeatureSelector
</code></pre><ul><li><a href=https://scikit-learn.org/dev/modules/feature_selection.html#sequential-feature-selection>User Guide</a></li><li><a href=https://scikit-learn.org/dev/auto_examples/feature_selection/plot_select_from_model_diabetes.html#sphx-glr-auto-examples-feature-selection-plot-select-from-model-diabetes-py>Model-based and sequential feature selection</a></li></ul></section><section><h1 id=successive-halving>Successive Halving</h1><p>A state of the art method to explore the space of the parameters and identify their best combination.</p><pre><code class=language-python>from sklearn.experimental import enable_halving_search_cv
from sklearn.model_selection import HalvingRandomSearchCV
</code></pre></section><section><h1 id=what-is-successive-halving>What is Successive Halving?</h1><figure><img src=images/halving.png width=650px></figure><ul><li><a href=https://scikit-learn.org/dev/modules/grid_search.html#successive-halving-user-guide>User Guide</a></li><li><a href=https://scikit-learn.org/dev/auto_examples/model_selection/plot_successive_halving_heatmap.html#sphx-glr-auto-examples-model-selection-plot-successive-halving-heatmap-py>Comparison between grid search and successive halving</a></li></ul></section><section><h1 id=major-improvements-to-documentation>Major Improvements to Documentation</h1><ul><li><a href=https://github.com/scikit-learn/scikit-learn/pull/18363>Random State</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/17095>Cross-Decomposition</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/16243>LDA and QDA</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/16234>Isotonic Regression</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/16178>Gradient Boosting</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/16114>Partial Dependence Curves</a></li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/15864>Fast PDP for Trees and Random Forest</a></li></ul></section><section><h1 id=estimator-api--check_estimator>Estimator API + <code>check_estimator</code></h1><ul><li>Refactored <code>check_estimator</code> for better maintainability</li><li><a href=https://github.com/scikit-learn/scikit-learn/pull/17361>Strict mode</a> to decide what is the minimal API of an <code>scikit-learn Estimator</code></li><li><a href=https://scikit-learn-enhancement-proposals.readthedocs.io/en/latest/slep010/proposal.html>SLEP010</a> <code>n_features_in_</code> + <code>_validate_data</code> method<ul><li>Builds scaffolding to enable supporting for different array types</li></ul></li></ul></section><section><h1 id=html-representation-of-html-default>HTML representation of HTML (default)</h1><pre><code class=language-python>clf
</code></pre><pre><code class=language-python>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['age', 'fare']),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value='missing',
                                                                                 strategy='constant')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  ['embarked', 'sex',
                                                   'pclass'])])),
                ('classifier', LogisticRegression())])
</code></pre></section><section data-noprocess><h1>HTML representation of HTML (now)</h1><section data-noprocess data-markdown data-separator=^\r?\n---\r?\n$ data-separator-vertical=^\r?\n------\r?\n$ data-separator-notes=notes?:><script type=text/template>
    <pre><code class="language-python">from sklearn import set_config
set_config(display='diagram')
clf
</code></pre>
<p></script></p></section><style>div.sk-top-container{color:#000;background-color:#fff}div.sk-toggleable{background-color:#fff}label.sk-toggleable__label{cursor:pointer;display:block;width:100%;margin-bottom:0;padding:.2em .3em;box-sizing:border-box;text-align:center}div.sk-toggleable__content{max-height:0;max-width:0;overflow:hidden;text-align:left;background-color:#f0f8ff}div.sk-toggleable__content pre{margin:.2em;color:#000;border-radius:.25em;background-color:#f0f8ff}input.sk-toggleable__control:checked~div.sk-toggleable__content{max-height:200px;max-width:100%;overflow:auto}div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label{background-color:#d4ebff}div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label{background-color:#d4ebff}input.sk-hidden--visually{border:0;clip:rect(1px 1px 1px 1px);clip:rect(1px,1px,1px,1px);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}div.sk-estimator{font-family:monospace;background-color:#f0f8ff;margin:.25em;border:1px dotted #000;border-radius:.25em;box-sizing:border-box}div.sk-estimator:hover{background-color:#d4ebff}div.sk-parallel-item::after{content:"";width:100%;border-bottom:1px solid gray;flex-grow:1}div.sk-label:hover label.sk-toggleable__label{background-color:#d4ebff}div.sk-serial::before{content:"";position:absolute;border-left:1px solid gray;box-sizing:border-box;top:2em;bottom:0;left:50%}div.sk-serial{display:flex;flex-direction:column;align-items:center;background-color:#fff}div.sk-item{z-index:1}div.sk-parallel{display:flex;align-items:stretch;justify-content:center;background-color:#fff}div.sk-parallel-item{display:flex;flex-direction:column;position:relative;background-color:#fff}div.sk-parallel-item:first-child::after{align-self:flex-end;width:50%}div.sk-parallel-item:last-child::after{align-self:flex-start;width:50%}div.sk-parallel-item:only-child::after{width:0}div.sk-dashed-wrapped{border:1px dashed gray;margin:.2em;box-sizing:border-box;padding-bottom:.1em;background-color:#fff;position:relative}div.sk-label label{font-family:monospace;font-weight:700;background-color:#fff;display:inline-block;line-height:1.2em}div.sk-label-container{position:relative;z-index:2;text-align:center}div.sk-container{display:inline-block;position:relative}</style><div class=sk-top-container><div class=sk-container><div class="sk-item sk-dashed-wrapped"><div class=sk-label-container><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=8a7af986-706b-472d-9c70-51cc6a9caba8 type=checkbox><label class=sk-toggleable__label for=8a7af986-706b-472d-9c70-51cc6a9caba8>Pipeline</label><div class=sk-toggleable__content><pre>Pipeline(steps=[('preprocessor',
                 ColumnTransformer(transformers=[('num',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(strategy='median')),
                                                                  ('scaler',
                                                                   StandardScaler())]),
                                                  ['age', 'fare']),
                                                 ('cat',
                                                  Pipeline(steps=[('imputer',
                                                                   SimpleImputer(fill_value='missing',
                                                                                 strategy='constant')),
                                                                  ('onehot',
                                                                   OneHotEncoder(handle_unknown='ignore'))]),
                                                  ['embarked', 'sex',
                                                   'pclass'])])),
                ('classifier', LogisticRegression())])</pre></div></div></div><div class=sk-serial><div class="sk-item sk-dashed-wrapped"><div class=sk-label-container><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=d8df9348-923b-4289-852b-bc0c9f014af6 type=checkbox><label class=sk-toggleable__label for=d8df9348-923b-4289-852b-bc0c9f014af6>preprocessor: ColumnTransformer</label><div class=sk-toggleable__content><pre>ColumnTransformer(transformers=[('num',
                                 Pipeline(steps=[('imputer',
                                                  SimpleImputer(strategy='median')),
                                                 ('scaler', StandardScaler())]),
                                 ['age', 'fare']),
                                ('cat',
                                 Pipeline(steps=[('imputer',
                                                  SimpleImputer(fill_value='missing',
                                                                strategy='constant')),
                                                 ('onehot',
                                                  OneHotEncoder(handle_unknown='ignore'))]),
                                 ['embarked', 'sex', 'pclass'])])</pre></div></div></div><div class=sk-parallel><div class=sk-parallel-item><div class=sk-item><div class=sk-label-container><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=cf0badb5-8104-45f6-9f41-caadbc17faeb type=checkbox><label class=sk-toggleable__label for=cf0badb5-8104-45f6-9f41-caadbc17faeb>num</label><div class=sk-toggleable__content><pre>['age', 'fare']</pre></div></div></div><div class=sk-serial><div class=sk-item><div class=sk-serial><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=58dac894-1abe-4727-b163-891a83fdd07b type=checkbox><label class=sk-toggleable__label for=58dac894-1abe-4727-b163-891a83fdd07b>SimpleImputer</label><div class=sk-toggleable__content><pre>SimpleImputer(strategy='median')</pre></div></div></div><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=28283f31-cfc1-455a-98cd-67b9ddd070d6 type=checkbox><label class=sk-toggleable__label for=28283f31-cfc1-455a-98cd-67b9ddd070d6>StandardScaler</label><div class=sk-toggleable__content><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class=sk-parallel-item><div class=sk-item><div class=sk-label-container><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=3a74ea9a-e73c-4481-a770-6c0cf69209cb type=checkbox><label class=sk-toggleable__label for=3a74ea9a-e73c-4481-a770-6c0cf69209cb>cat</label><div class=sk-toggleable__content><pre>['embarked', 'sex', 'pclass']</pre></div></div></div><div class=sk-serial><div class=sk-item><div class=sk-serial><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=c62e0c4e-902b-43b2-8e14-ece22b60f599 type=checkbox><label class=sk-toggleable__label for=c62e0c4e-902b-43b2-8e14-ece22b60f599>SimpleImputer</label><div class=sk-toggleable__content><pre>SimpleImputer(fill_value='missing', strategy='constant')</pre></div></div></div><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=35df2cb1-6742-4587-b270-e43745dbb550 type=checkbox><label class=sk-toggleable__label for=35df2cb1-6742-4587-b270-e43745dbb550>OneHotEncoder</label><div class=sk-toggleable__content><pre>OneHotEncoder(handle_unknown='ignore')</pre></div></div></div></div></div></div></div></div></div></div><div class=sk-item><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id=dc06abd2-ea7e-4f28-af77-0fa90148eca3 type=checkbox><label class=sk-toggleable__label for=dc06abd2-ea7e-4f28-af77-0fa90148eca3>LogisticRegression</label><div class=sk-toggleable__content><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></section></section></section><section><section data-shortcode-section><h1 id=improvements-of-the-new-fast-gradient-boosting-models->Improvements of the new fast gradient boosting models ðŸŒ²</h1><pre><code class=language-python>from sklearn.experimental import enable_hist_gradient_boosting

from sklearn.ensemble import HistGradientBoostingClassifier
from sklearn.ensemble import HistGradientBoostingRegressor
</code></pre></section><section><h1 id=missing-value-support>Missing Value Support</h1><pre><code class=language-python>from sklearn.experimental import enable_hist_gradient_boosting
from sklearn.ensemble import HistGradientBoostingClassifier

X = np.array([0, 1, 2, np.nan]).reshape(-1, 1)
y = [0, 0, 1, 1]

gbdt = HistGradientBoostingClassifier(min_samples_leaf=1).fit(X, y)
</code></pre></section><section><h1 id=gradient-boosting-with-poisson-distributions>Gradient Boosting with Poisson Distributions</h1><pre><code class=language-python>from sklearn.experimental import enable_hist_gradient_boosting
from sklearn.ensemble import HistGradientBoostingRegressor

reg = HistGradientBoostingRegressor(loss=&quot;poisson&quot;)
</code></pre><figure><img src=images/glm-dist.png></figure><p><a href=https://scikit-learn.org/dev/auto_examples/linear_model/plot_poisson_regression_non_normal_loss.html#gradient-boosting-regression-trees-for-poisson-regression>Gradient Boosting Regression Trees for Poisson regression example</a></p></section><section><h1 id=categorical-support>Categorical Support</h1><pre><code class=language-python>from sklearn.experimental import enable_hist_gradient_boosting
from sklearn.ensemble import HistGradientBoostingRegressor

categorical_mask = ([True] * n_categorical_features +
                    [False] * n_numerical_features)

reg = HistGradientBoostingRegressor(categorical_features=categorical_mask)
</code></pre></section><section><h1 id=categorical-advantages>Categorical Advantages</h1><figure><img src=images/categorical-hist.png height=500px></figure><p><a href=https://scikit-learn.org/dev/auto_examples/ensemble/plot_gradient_boosting_categorical.html#sphx-glr-auto-examples-ensemble-plot-gradient-boosting-categorical-py>Categorical Feature Support in Gradient Boosting</a></p></section></section><section><h1 id=conclusion>Conclusion</h1><figure><img src=images/scikit-learn-logo.png width=200px></figure><p><strong>scikit-learn 0.24rc</strong> has been released!</p><pre><code class=language-bash>pip install scikit-learn==0.24.0rc
</code></pre><ol><li>Organizational Updates @ scikit-learn</li><li>Advances in scikit-learn</li><li>Improvements of the new fast gradient boosting models</li></ol><p><br></p><p><strong>Thomas J. Fan</strong><p class=social-author>@thomasjpfan</p><a href=https://www.github.com/thomasjpfan target=_blank><span class="icon icon-github icon-left"></span></a><a href=https://www.twitter.com/thomasjpfan target=_blank><span class="icon icon-twitter"></span></a></p><div></div><a class=this-talk-link , href=https://github.com/thomasjpfan/2020-czi-scikit-learn target=_blank>This talk on Github: thomasjpfan/2020-czi-scikit-learn</a></section></div></div><script type=text/javascript src=/2020-czi-scikit-learn/reveal-hugo/object-assign.js></script><a href=/2020-czi-scikit-learn/reveal-js/css/print/ id=print-location style=display:none></a><script type=text/javascript>var printLocationElement=document.getElementById('print-location');var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href=printLocationElement.href+(window.location.search.match(/print-pdf/gi)?'pdf.css':'paper.css');document.getElementsByTagName('head')[0].appendChild(link);</script><script type=application/json id=reveal-hugo-site-params>{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"height":720,"highlight_theme":"monokai","transition_speed":"fast","width":1280}</script><script type=application/json id=reveal-hugo-page-params>null</script><script src=/2020-czi-scikit-learn/reveal-js/js/reveal.js></script><script type=text/javascript>function camelize(map){if(map){Object.keys(map).forEach(function(k){newK=k.replace(/(\_\w)/g,function(m){return m[1].toUpperCase()});if(newK!=k){map[newK]=map[k];delete map[k];}});}
return map;}
var revealHugoDefaults={center:true,controls:true,history:true,progress:true,transition:"slide"};var revealHugoSiteParams=JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);var revealHugoPageParams=JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);var options=Object.assign({},camelize(revealHugoDefaults),camelize(revealHugoSiteParams),camelize(revealHugoPageParams));Reveal.initialize(options);</script><script type=text/javascript src=/2020-czi-scikit-learn/reveal-js/plugin/markdown/marked.js></script><script type=text/javascript src=/2020-czi-scikit-learn/reveal-js/plugin/markdown/markdown.js></script><script type=text/javascript src=/2020-czi-scikit-learn/reveal-js/plugin/highlight/highlight.js></script><script type=text/javascript src=/2020-czi-scikit-learn/reveal-js/plugin/zoom-js/zoom.js></script><script type=text/javascript src=/2020-czi-scikit-learn/reveal-js/plugin/notes/notes.js></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}};</script><script type=text/javascript id=MathJax-script async src=https://thomasjpfan.github.io/2020-czi-scikit-learn//javascript/tex-svg.js></script><link rel="shortcut icon" href=https://thomasjpfan.github.io/2020-czi-scikit-learn//favicon.ico></body></html>